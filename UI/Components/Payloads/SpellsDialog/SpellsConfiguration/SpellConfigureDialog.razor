@using Shared.Enums
<MatDialog @bind-IsOpen="@IsSpellDialogOpen">
    <MatDialogTitle>Configure @SpellToLaunch?.Title</MatDialogTitle>
    <MatDialogContent>

        @if (SpellToLaunch?.ConfigurationNeeded.Contains(Enums.SpellConfiguration.AntivirusToUse) == true)
        {
            <MatSelectItem @bind-Value="ChosenAntivirus" Items="@Antiviruses" Label="Antivirus">
            </MatSelectItem>
        }
        @if (SpellToLaunch?.ConfigurationNeeded.Contains(Enums.SpellConfiguration.FilesFromPayloadToScan) == true)
        {
            <FilesConfigure></FilesConfigure>
        }

    </MatDialogContent>
    <MatDialogActions>
        <MatButton OnClick=@LaunchScan>Launch</MatButton>
    </MatDialogActions>
</MatDialog>

@code {
    [Parameter]
    public bool IsSpellDialogOpen { get; set; }

    public SupportedAntivirus ChosenAntivirus { get; set; }

    [Parameter]
    public OrbitalScan SpellToLaunch { get; set; }

    [Parameter]
    public EventCallback<List<SupportedAntivirus>> OnConfigured { get; set; }

    public List<SupportedAntivirus> Antiviruses { get; set; }
        = Enum.GetValues(typeof(SupportedAntivirus)).Cast<SupportedAntivirus>().ToList();

    private async Task LaunchScan()
    {
        await OnConfigured.InvokeAsync(new List<SupportedAntivirus> { ChosenAntivirus });
    }
}
